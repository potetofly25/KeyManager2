<!-- メインウィンドウの定義：アプリ全体の一覧画面 -->
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:potetofly25.KeyManager2.ViewModels"
        x:Class="potetofly25.KeyManager2.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="KeyManager2" Width="1200" Height="600">
    
    <!-- 画面全体をレイアウトする DockPanel -->
    <DockPanel Margin="12">

        <!-- 上部の検索バーとカテゴリフィルタ、リフレッシュボタンエリア -->
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Spacing="8">
            <!-- テキスト検索ボックス：SearchText と双方向バインド -->
            <TextBox Width="320"
                     Watermark="Search"
                     Text="{Binding SearchText, Mode=TwoWay}"/>

            <!-- カテゴリ選択コンボボックス：Categories から選択し SelectedCategory にバインド -->
            <ComboBox ItemsSource="{Binding Categories}"
                      SelectedItem="{Binding SelectedCategory, Mode=TwoWay}"
                      MinWidth="150" >
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <!-- カテゴリ名を表示する TextBlock（単純な文字列バインド） -->
                        <TextBlock Text="{Binding}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <!-- 手動で一覧を再読み込みする Refresh ボタン -->
            <Button Content="更新"
                    Command="{Binding RefreshCommand}"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Width="120" />
        </StackPanel>

        <!-- 下部の操作ボタン群：新規、編集、削除、コピー、マスター設定、エクスポート、インポート -->
        <StackPanel DockPanel.Dock="Bottom"
                    Orientation="Horizontal"
                    Spacing="8"
                    Margin="0,8,0,0">

            <!-- 新規レコード作成ボタン（コードビハインドで Click をハンドル） -->
            <Button Name="NewBtn"
                    Content="追加"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Width="120"/>

            <!-- 選択行を編集するボタン -->
            <Button Name="EditBtn"
                    Content="選択編集"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Width="120"/>

            <!-- 選択行を削除するボタン -->
            <Button Name="DeleteBtn"
                    Content="選択削除"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Width="120"/>

            <!-- 選択行のパスワードをクリップボードへコピーするボタン -->
            <Button Name="CopyBtn"
                    Content="コピーパスワード"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Width="120"/>

            <!-- マスターパスワードを設定／変更するボタン -->
            <Button Name="SetMasterBtn"
                    Content="マスターパスワード設定"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Width="180"/>

            <!-- バックアップファイルへのエクスポートボタン -->
            <Button Name="ExportBtn"
                    Content="バックアップエクスポート"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Width="180"/>

            <!-- バックアップファイルからのインポートボタン -->
            <Button Name="ImportBtn"
                    Content="バックアップインポート"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Width="180"/>
        </StackPanel>
    
        <!-- 中央エリア：左側にタグクラウド、右側に DataGrid を配置 -->

        <Grid ColumnDefinitions="200,*" RowDefinitions="Auto,*">

            <!-- 左側：タグクラウド表示エリア -->
            <StackPanel Grid.Column="0" Margin="8">
                <TextBlock Text="Tag Cloud" FontWeight="Bold"/>
                <!-- タグクラウドをスクロール可能にする ScrollViewer -->
                <ScrollViewer Height="400">
                    <!-- コードビハインド側から動的にタグを追加する WrapPanel -->
                    <WrapPanel Name="TagCloudPanel" />
                </ScrollViewer>
            </StackPanel>
            
            <!-- 右側：資格情報一覧を表示する DataGrid -->
            <DataGrid Name="DataGrid"
                      Grid.Column="1"
                      ItemsSource="{Binding Credentials}"
                      AutoGenerateColumns="False">
                <DataGrid.Columns>
                    <!-- ID 列（読み取り専用） -->
                    <DataGridTextColumn Header="ID"
                                        Binding="{Binding Id}"
                                        Width="50"
                                        IsReadOnly="True"/>
                    <!-- LoginId 列 -->
                    <DataGridTextColumn Header="Login"
                                        Binding="{Binding LoginId}"
                                        Width="2*"/>
                    <!-- Password 列（暗号化された文字列、または復号されたパスワード） -->
                    <DataGridTextColumn Header="Password"
                                        Binding="{Binding Password}"
                                        Width="2*"/>
                    <!-- Category 列 -->
                    <DataGridTextColumn Header="Category"
                                        Binding="{Binding Category}"
                                        Width="*"/>
                    <!-- Tags 列（カンマ区切りのタグ文字列） -->
                    <DataGridTextColumn Header="Tags"
                                        Binding="{Binding Tags}"
                                        Width="2*"/>
                    <!-- Description 列（用途やメモなどの説明） -->
                    <DataGridTextColumn Header="Description"
                                        Binding="{Binding Description}"
                                        Width="3*"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>

    </DockPanel>
</Window>
